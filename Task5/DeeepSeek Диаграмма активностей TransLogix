@startuml
title Диаграмма активностей обработки заказа TransLogix

start

:Получить новый заказ;
note right
  Детали заказа получены
  через клиентский портал
end note

:Проверить данные заказа;
if (Данные корректны?) then (да)
else (нет)
  :Отклонить заказ;
  :Отправить уведомление об отклонении;
  stop
endif

fork
  :Зарезервировать товары на складе;
  :Обновить статус склада;
fork again
  :Запустить оптимизацию маршрута;
  :Анализ моделью ИИ/МО;
  :Сгенерировать оптимальный маршрут;
end fork

:Рассчитать ожидаемое время доставки;
:Подтвердить заказ с клиентом;

if (Клиент подтвердил?) then (да)
  :Назначить дату доставки;
  :Назначить транспортное средство;
  :Подготовить сопроводительные документы;
else (нет)
  :Поставить заказ на удержание;
  :Уведомить отдел продаж;
  stop
endif

:Погрузить товар для доставки;
:Начать транспортировку;

while (В пути?) is (да)
  :Отслеживать местоположение транспорта;
  :Мониторить дорожную обстановку;
  if (Отклонение от маршрута?) then (да)
    :Пересчитать маршрут;
    :Обновить ожидаемое время прибытия;
  else (нет)
  endif
  :Обновить статус в реальном времени;
endwhile (нет)

:Прибыть в пункт назначения;
:Разгрузить товар;
:Получить подпись клиента;

if (Доставка успешна?) then (да)
  :Обновить заказ как доставленный;
  :Обработать платеж;
  :Сформировать отчет о доставке;
  :Архивировать данные заказа;
else (нет)
  :Зафиксировать проблему доставки;
  :Эскалировать в поддержку;
  :Запустить процесс возврата;
endif

:Обновить базу данных аналитики;
:Отправить уведомление о завершении;

stop

@enduml